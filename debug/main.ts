import { CMap } from "../src/modules/CMap";
import '../src/styles/index.scss'
import { initShip } from "./ship";
import { registerTack } from "./track";
import { Point } from '@/modules/Plot/plugins/Point'
import { IndexPoint } from '@/modules/Plot/plugins/IndexPoint'
import { IconPoint } from '@/modules/Plot/plugins/IconPoint'
import { LngLat } from 'mapbox-gl'
import { Tooltip } from '@/core/Tooltip'
import IconManager from "../src/core/IconManager";
import { Line } from '../src/modules/Plot/plugins/Line'

const cMap = new CMap({
  container: 'map',
  type: CMap.LAND,
  center: [122.09160659512042, 30.004767949301183],
  zoom: 14,
});

setTimeout(() => {
  // cMap.change(CMap.LAND)
}, 2000)

cMap.on('loaded', (map) => {

  window.map = map

  // map.showCollisionBoxes = true
  const flag = false

  if (flag) {
    initShip(cMap)
  }

  const trackFlag = false

  if (trackFlag) {
    registerTack(map)
  }

  // const point = new Point(map, {
  //   id: '3',
  //   name: '测试' + Date.now(),
  //   tooltip: true,
  // })
  //
  // point.start()
  //
  // point.once('Point.create', (data) => {
  //   console.log(data, 'dakdhajhdja');
  //   point.edit()
  // })

  // Tooltip.DEBUG = true
  //

  const manage = new IconManager(map)
  manage.addSvg({
    name: 'fire',
    svg: '<svg t="1772112463399" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14473" width="32" height="32"><path d="M521.362286 1012.053333l18.602666-23.405714 18.383238-22.79619 18.212572-22.25981 26.819048-32.426667 34.791619-41.520762 57.636571-68.729904 23.235048-28.16 14.945523-18.407619 14.457905-18.188191 13.970286-17.944381 13.458286-17.749333C852.845714 597.382095 902.095238 502.637714 902.095238 390.095238c0-215.454476-174.640762-390.095238-390.095238-390.095238S121.904762 174.640762 121.904762 390.095238c0 114.249143 49.688381 211.72419 128.195048 317.269333l13.750857 18.188191c2.340571 3.023238 4.681143 6.095238 7.070476 9.142857l14.531047 18.456381 15.043048 18.70019 15.530667 18.944 15.993905 19.236572 24.795428 29.427809 79.481905 93.452191 27.891809 33.158095 18.944 22.77181 19.18781 23.283809 0.097524 0.121905a12.141714 12.141714 0 0 0 18.944-0.170667z" fill="#3388FF" p-id="14474"></path><path d="M512 390.095238m-341.333333 0a341.333333 341.333333 0 1 0 682.666666 0 341.333333 341.333333 0 1 0-682.666666 0Z" fill="#FFFFFF" p-id="14475"></path><path d="M512.536381 170.666667a70.119619 70.119619 0 0 1 41.276952 126.829714l-3.900952 2.657524-3.803429 2.194285v6.777905h90.136381v65.755429H546.133333v126.927238c61.878857-8.923429 111.34781-49.005714 132.949334-90.843429l2.291809-4.681143 2.048-4.63238c5.339429-12.921905 3.34019-19.797333-2.925714-23.990858a19.260952 19.260952 0 0 0-5.022476-2.413714l-1.219048-0.292571-13.336381-2.340572 69.36381-68.900571 1.072762 18.18819 0.097523 4.85181v4.388571c-0.414476 49.590857-11.288381 102.009905-39.424 144.652191-20.114286 30.47619-40.057905 51.126857-60.830476 64.926476a146.651429 146.651429 0 0 1-18.578286 10.483809l-7.875047 3.486477-26.136381 9.825523-26.453333 8.801524-6.241524 2.194286-3.681524 1.389714-18.407619 18.285715-2.779429 4.461714-2.048 3.023238-4.924952 6.777905L512 607.329524l-2.121143 2.169905-4.87619-6.948572a61.147429 61.147429 0 0 1-3.193905-4.949333l-0.536381-1.121524-19.431619-19.577905-3.730286-1.438476-6.217143-2.194286-22.113523-7.289904-8.411429-2.950096-20.114286-7.582476-3.34019-1.365333a149.625905 149.625905 0 0 1-25.063619-13.385143c-20.772571-13.799619-40.71619-34.450286-60.830476-64.926476-26.477714-40.131048-37.668571-88.917333-39.253334-135.92381L292.571429 331.093333l0.048761-7.289904 0.170667-4.510477 0.950857-15.579428 69.36381 68.900571-13.336381 2.340572a17.871238 17.871238 0 0 0-6.241524 2.706285c-6.265905 4.193524-8.240762 11.093333-2.925714 23.966477 18.67581 45.104762 70.826667 90.599619 137.020952 100.205714l1.316572 0.121905v-127.073524h-90.112v-65.755429h90.112v-6.753524l-3.779048-2.218666a70.144 70.144 0 0 1-32.109714-50.249143l-0.438857-4.510476-0.146286-4.559238A70.119619 70.119619 0 0 1 512.536381 170.666667z m0 50.639238a19.480381 19.480381 0 0 0-19.407238 19.553524c0 10.800762 8.704 19.553524 19.407238 19.553523a19.504762 19.504762 0 0 0 19.407238-19.553523 19.504762 19.504762 0 0 0-19.407238-19.553524z" fill="#3388FF" p-id="14476"></path></svg>',
  })

  // const icon = new IconPoint(map, {
  //   id: '1',
  //   name: '浙江宝驿4s店',
  //   icon: 'fire',
  //   style: {
  //     "icon-anchor": 'bottom',
  //   },
  //   position: new LngLat(122.09860659512042, 30.004767949301183)
  // })
  //
  // icon.render()
  // icon.edit()
  //

  // const index = new IndexPoint(map, {
  //   id: '2',
  //   name: '浙江宝驿4s店',
  //   index: 1,
  //   style: {
  //     'text-color': '#f00'
  //   },
  //   position: new LngLat(122.09660659512042, 30.004767949301183)
  // })
  //
  // index.render()
  // index.edit()

  // //
  // // //
  // // // // index.on('dblclick', () => {
  // // // //   index.edit()
  // // // // })
  // // //
  // // // index.edit()
  // //
  // const point = new Point(map, {
  //   id: '3',
  //   name: '浙江宝驿4s店',
  //   tooltip: true,
  //   position: new LngLat(122.09360659512042, 30.004767949301183)
  // })
  //
  // point.render()
  //
  // point.edit()
  //
  // point.on('hover', (data) => {
  //   console.log(data, 'point');
  // })
  //
  // const point1= new Point(map, {
  //   id: '12',
  //   name: '23',
  //   tooltip: true,
  //   position: new LngLat(122.09560659512042, 30.004767949301183)
  // })
  //
  // point1.on('hover', (data) => {
  //   console.log(data, 'point1');
  // })
  //
  // point1.render()

  const line = new Line(map, {
    id: '1234',
    // position: [
    //   new LngLat(122.09860659512042, 30.004767949301183),
    //   new LngLat(122.09660659512042, 30.004767949301183),
    //   new LngLat(122.09360659512042, 30.004767949301183),
    //   new LngLat(122.08960659512042, 30.004767949301183),
    // ],
    vertexStyle: {
      'circle-radius': 5,
    },
    midStyle: {
      'circle-radius': 2, // 中点通常画小一点
      'circle-color': '#f00', // 颜色区分，比如灰色
    },
  })

  line.render()
  line.start()
  // line.edit()
  // setTimeout(() => {
  //   line.unedit()
  // }, 3000)
})
